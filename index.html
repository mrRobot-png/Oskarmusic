<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DompetHarian</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f4f4f9; color: #333; }
        .card { background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 15px; }
        h2 { margin: 0; color: #2c3e50; }
        .balance { font-size: 1.5rem; font-weight: bold; color: #27ae60; }
        input { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        .btn-group { display: flex; gap: 10px; }
        button { flex: 1; padding: 12px; border: none; border-radius: 5px; color: white; cursor: pointer; font-weight: bold; }
        .btn-inc { background: #27ae60; }
        .btn-exp { background: #e74c3c; }
        .btn-target { background: #3498db; }
        ul { list-style: none; padding: 0; }
        li { background: white; padding: 10px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; }
        .date-header { font-size: 0.9rem; color: #7f8c8d; }
    </style>
</head>
<body>

    <div class="card">
        <div class="date-header" id="currentDate"></div>
        <h2>Balance: <span id="balanceText">Rp 0</span></h2>
        <div id="dailyLimitText" style="color: #e67e22; font-size: 0.9rem; margin-top: 5px;"></div>
    </div>

    <div class="card">
        <input type="number" id="amount" placeholder="Amount (Rp)">
        <input type="text" id="note" placeholder="What is this for?">
        <div class="btn-group">
            <button class="btn-inc" onclick="addTransaction('Income')">ADD +</button>
            <button class="btn-exp" onclick="addTransaction('Expense')">SUB -</button>
        </div>
    </div>

    <div class="card">
        <h3>Budget Target</h3>
        <input type="number" id="targetTotal" placeholder="Target Total Money (e.g. 300000)">
        <input type="number" id="targetDays" placeholder="Survival Days (e.g. 30)">
        <button class="btn-target" onclick="setTarget()">Calculate Daily Limit</button>
    </div>

    <h3>History Log</h3>
    <ul id="historyList"></ul>

    <script>
        let balance = parseFloat(localStorage.getItem('balance')) || 0;
        let history = JSON.parse(localStorage.getItem('history')) || [];
        let dailyLimit = localStorage.getItem('dailyLimit') || 0;

        function updateUI() {
            document.getElementById('balanceText').innerText = `Rp ${balance.toLocaleString('id-ID')}`;
            document.getElementById('currentDate').innerText = new Date().toLocaleDateString('id-ID', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            document.getElementById('dailyLimitText').innerText = dailyLimit > 0 ? `Max Daily Spending: Rp ${parseFloat(dailyLimit).toLocaleString('id-ID')}` : "";
            
            const list = document.getElementById('historyList');
            list.innerHTML = history.map(item => `
                <li>
                    <span><strong>${item.type}:</strong> ${item.note}</span>
                    <span style="color: ${item.type === 'Income' ? 'green' : 'red'}">
                        ${item.type === 'Income' ? '+' : '-'} Rp ${item.amount.toLocaleString('id-ID')}
                    </span>
                </li>
            `).reverse().join('');
        }

        function addTransaction(type) {
            const amount = parseFloat(document.getElementById('amount').value);
            const note = document.getElementById('note').value || "No note";
            if (isNaN(amount)) return alert("Enter a valid amount");

            if (type === 'Income') balance += amount;
            else balance -= amount;

            history.push({ type, amount, note, date: new Date().toISOString() });
            save();
            document.getElementById('amount').value = '';
            document.getElementById('note').value = '';
            updateUI();
        }

        function setTarget() {
            const total = parseFloat(document.getElementById('targetTotal').value);
            const days = parseFloat(document.getElementById('targetDays').value);
            if (total > 0 && days > 0) {
                dailyLimit = (total / days).toFixed(0);
                save();
                updateUI();
            }
        }

        function save() {
            localStorage.setItem('balance', balance);
            localStorage.setItem('history', JSON.stringify(history));
            localStorage.setItem('dailyLimit', dailyLimit);
        }

        updateUI();
    </script>
</body>
</html>
